# TURN Server Configuration for End-to-End Encrypted Messaging
# Uses coturn for WebRTC relay when direct peer connections fail

# Network configuration
listening-port=3478
tls-listening-port=5349
alt-listening-port=3479
alt-tls-listening-port=5350

# Realm - your domain
realm=silentrelay.com.au
server-name=silentrelay.com.au

# Authentication
# Use time-limited credentials for better security
use-auth-secret
# The secret is passed via TURN_SECRET environment variable
# Coturn reads from environment when config value matches env var name
static-auth-secret=${TURN_SECRET}

# For static credentials (simpler but less secure):
# lt-cred-mech
# user=messenger:SecurePassword123!

# Message integrity
fingerprint

# Logging
log-file=/var/log/coturn/turnserver.log
verbose
# Uncomment for detailed debugging:
# Verbose

# SSL/TLS Configuration (use your Let's Encrypt certs)
cert=/etc/ssl/certs/fullchain.pem
pkey=/etc/ssl/certs/privkey.pem

# Cipher suites (modern TLS 1.2+)
cipher-list="ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305"
dh2066

# Security settings
no-multicast-peers
no-tcp-relay
no-cli

# Limit bandwidth per session (1 Mbps - adjust as needed)
max-bps=1000000

# Limit total bandwidth (100 Mbps - adjust based on server capacity)
total-quota=100

# Session limits
user-quota=12
stale-nonce=600

# Allowed peer addresses (optional - restrict to specific networks)
# denied-peer-ip=0.0.0.0-0.255.255.255
# denied-peer-ip=10.0.0.0-10.255.255.255
# denied-peer-ip=192.168.0.0-192.168.255.255

# Mobility (for users switching networks)
mobility

# External IP (required for NAT environments)
external-ip=72.60.195.231

# Relay threads (one per CPU core is good)
# relay-threads=4


